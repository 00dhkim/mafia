PRD(Product Requirements Document)

## 프로젝트 개요

본 프로젝트는 터미널 기반의 AI 마피아 게임 개발을 목표로 합니다. 각 플레이어는 독립적인 LLM(Large Language Model) 에이전트로 구현되며, 턴 기반으로 게임이 진행됩니다. 시민 팀 5명(의사 1명, 경찰 1명, 시민 3명)과 마피아 팀 2명으로 구성되며, MVP 개발에 집중하여 핵심 기능의 완성도를 높이는 것을 목표로 합니다. 프로덕트 실행 중에 사용자의 개입은 없으며, LLM 에이전트 간의 대화를 관측하여 LLM 기술의 완성도를 파악하는 것이 본 프로젝트의 목적입니다.

## 프로덕트 플로우

1. 게임 시작: 플레이어 역할 분배
2. 낮 단계:
   - 생존자 확인
   - 플레이어 간 대화
   - 투표를 통한 추방 대상 선정
3. 밤 단계:
   - 마피아의 살해 대상 선정
   - 의사의 치료 대상 선정
   - 경찰의 조사 대상 선정
4. 결과 확인 및 다음 턴으로 이동
5. 승리 조건 달성 시 게임 종료

## 핵심 기능

1. 게임 진행 관리
   - 턴 기반 게임 진행 (낮/밤 단계 구분)
   - 플레이어 상태 및 역할 관리
   - 현재 게임 상태 파악 (생존자 수, 투표 결과 등)

2. AI 플레이어 구현
   - 각 플레이어를 독립적인 LLM 에이전트로 구현
   - 게임 상황 인식 및 의사결정 능력
   - 역할에 따른 적절한 행동 선택
   - 자연스러운 대화 생성 기능
   - 거짓말 탐지 및 수행 능력 (마피아 역할)

3. 메모리 관리
   - 이전 턴의 정보 및 플레이어 행동 기록 저장
   - 장기 기억을 통한 일관된 전략 유지

4. 특수 능력 구현
   - 의사: 치료 능력
   - 경찰: 조사 능력
   - 마피아: 살해 능력

5. 터미널 인터페이스
   - 게임 상황 및 대화 내용 출력
   - 플레이어 행동 입력 처리

## 기술 스택

1. 프로그래밍 언어: Python 3.8+
2. LLM API: OpenAI GPT-3.5 또는 GPT-4
3. 게임 로직: 자체 개발
4. 데이터 저장: JSON
5. 버전 관리: Git

## MVP 기능 개발 이후 추가 개선사항

1. 그래픽 사용자 인터페이스(GUI) 구현
2. 다양한 특수 역할 추가 (예: 군인, 기자 등)
3. 플레이어 수 조정 기능
4. 게임 난이도 설정 기능
5. 멀티플레이어 온라인 모드 구현
6. 게임 로그 분석 및 통계 기능
7. 사용자 정의 규칙 설정 기능


## 마피아 게임 절차

1. "blah~", 낮 대화
2. 혼자 생각. known_roles, suspicious_players, trusted_players
3. "blah~", 낮 투표, "지목 결과, [{player} {vote}표 for players]로 {player}가 마피아로 지목당해 처형되었습니다."
4. "[private] 마피아는 공격할 사람을 선택해 주세요", 밤 마피아 능력사용
5. "[private] 의사는 살릴 사람을 선택해 주세요", 밤 의사 능력사용
6. "[private] 경찰은 조사할 사람을 선택해 주세요", 밤 경찰 능력사용, "[private] {player}는 마피아가 맞습니다."
7. 공지 "{player}가 마피아에 의해 죽었습니다." / "{player}가 의사의 치료를 받고 살아났습니다."


## TODO

game_knowledge 객체의 업데이트 로직 추가
시스템 메시지 추가 (receive_public_info의 이름 바꾸자)
game_manager에 base_player의 discuss, vote 호출 로직 추가

parsed_response, validated_response 함수 검증
그리고 llm_agent 함수들 검증
player들에서 generate_response 호출하는 부분 읽어보고 구현
